



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Documentation for AutoKeras.">
      
      
        <link rel="canonical" href="http://autokeras.com/auto_model/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="/img/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.2">
    
    
      
        <title>auto_model - AutoKeras</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.30686662.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#ef5350">
      
    
    
      <script src="../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-44322747-3", "autokeras.com")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="red" data-md-color-accent="red">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#automodel-class" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="http://autokeras.com" title="AutoKeras" class="md-header-nav__button md-logo">
          
            <img src="/img/logo_white.svg" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              AutoKeras
            </span>
            <span class="md-header-nav__topic">
              
                auto_model
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/keras-team/autokeras" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="http://autokeras.com" title="AutoKeras" class="md-nav__button md-logo">
      
        <img src="/img/logo_white.svg" width="48" height="48">
      
    </a>
    AutoKeras
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/keras-team/autokeras" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../start/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../docker/" title="Docker" class="md-nav__link">
      Docker
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../contributing/" title="Contributing Guide" class="md-nav__link">
      Contributing Guide
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../nas/" title="Neural Architecture Search" class="md-nav__link">
      Neural Architecture Search
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked>
    
    <label class="md-nav__link" for="nav-6">
      Documentation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Documentation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        auto_model
      </label>
    
    <a href="./" title="auto_model" class="md-nav__link md-nav__link--active">
      auto_model
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#automodel-class" class="md-nav__link">
    AutoModel class
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#automodel-methods" class="md-nav__link">
    AutoModel methods
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fit" class="md-nav__link">
    fit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#predict" class="md-nav__link">
    predict
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#graphautomodel-class" class="md-nav__link">
    GraphAutoModel class
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#graphautomodel-methods" class="md-nav__link">
    GraphAutoModel methods
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fit_1" class="md-nav__link">
    fit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#predict_1" class="md-nav__link">
    predict
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2" type="checkbox" id="nav-6-2">
    
    <label class="md-nav__link" for="nav-6-2">
      hypermodel
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-2">
        hypermodel
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../hypermodel/block/" title="block" class="md-nav__link">
      block
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../about/" title="About" class="md-nav__link">
      About
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#automodel-class" class="md-nav__link">
    AutoModel class
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#automodel-methods" class="md-nav__link">
    AutoModel methods
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fit" class="md-nav__link">
    fit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#predict" class="md-nav__link">
    predict
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#graphautomodel-class" class="md-nav__link">
    GraphAutoModel class
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#graphautomodel-methods" class="md-nav__link">
    GraphAutoModel methods
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fit_1" class="md-nav__link">
    fit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#predict_1" class="md-nav__link">
    predict
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>auto_model</h1>
                
                <p><span style="float:right;"><a href="https://github.com/keras-team/keras/blob/master/autokeras/auto_model.py#L14">[source]</a></span></p>
<h2 id="automodel-class">AutoModel class</h2>
<pre><code class="python">autokeras.auto_model.AutoModel(inputs, outputs, name='auto_model', max_trials=100, directory=None, seed=None)
</code></pre>

<p>A Model defined by inputs and outputs.</p>
<p>AutoModel combines a HyperModel and a Tuner to tune the HyperModel.
The user can use it in a similar way to a Keras model since it
also has <code>fit()</code> and  <code>predict()</code> methods.</p>
<p>The user can specify the inputs and outputs of the AutoModel. It will infer
the rest of the high-level neural architecture.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>inputs</strong>: A list of or a HyperNode instance.
    The input node(s) of the AutoModel.</li>
<li><strong>outputs</strong>: A list of or a HyperHead instance.
    The output head(s) of the AutoModel.</li>
<li><strong>name</strong>: String. The name of the AutoModel. Defaults to 'auto_model'.</li>
<li><strong>max_trials</strong>: Int. The maximum number of different Keras Models to try.
    The search may finish before reaching the max_trials. Defaults to 100.</li>
<li><strong>directory</strong>: String. The path to a directory for storing the search outputs.
    Defaults to None, which would create a folder with the name of the
    AutoModel in the current directory.</li>
<li><strong>seed</strong>: Int. Random seed.</li>
</ul>
<hr />
<h2 id="automodel-methods">AutoModel methods</h2>
<h3 id="fit">fit</h3>
<pre><code class="python">fit(x=None, y=None, validation_split=0, validation_data=None)
</code></pre>

<p>Search for the best model and hyperparameters for the AutoModel.</p>
<p>It will search for the best model based on the performances on
validation data.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>x</strong>: numpy.ndarray or tensorflow.Dataset. Training data x.</li>
<li><strong>y</strong>: numpy.ndarray or tensorflow.Dataset. Training data y.</li>
<li><strong>validation_split</strong>: Float between 0 and 1.
    Fraction of the training data to be used as validation data.
    The model will set apart this fraction of the training data,
    will not train on it, and will evaluate
    the loss and any model metrics
    on this data at the end of each epoch.
    The validation data is selected from the last samples
    in the <code>x</code> and <code>y</code> data provided, before shuffling. This argument is
    not supported when <code>x</code> is a dataset.</li>
<li>
<p><strong>validation_data</strong>: Data on which to evaluate
    the loss and any model metrics at the end of each epoch.
    The model will not be trained on this data.
    <code>validation_data</code> will override <code>validation_split</code>.
    <code>validation_data</code> could be:</p>
<ul>
<li>tuple <code>(x_val, y_val)</code> of Numpy arrays or tensors</li>
<li>tuple <code>(x_val, y_val, val_sample_weights)</code> of Numpy arrays</li>
<li>dataset or a dataset iterator</li>
</ul>
<p>For the first two cases, <code>batch_size</code> must be provided.
For the last case, <code>validation_steps</code> must be provided.</p>
</li>
<li>
<p><strong>**kwargs</strong>: Any arguments supported by keras.Model.fit.</p>
</li>
</ul>
<hr />
<h3 id="predict">predict</h3>
<pre><code class="python">predict(x, batch_size=32)
</code></pre>

<p>Predict the output for a given testing data.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>x</strong>: tf.data.Dataset or numpy.ndarray. Testing data.</li>
<li><strong>batch_size</strong>: Int. Defaults to 32.</li>
<li><strong>**kwargs</strong>: Any arguments supported by keras.Model.predict.</li>
</ul>
<hr />
<p><span style="float:right;"><a href="https://github.com/keras-team/keras/blob/master/autokeras/auto_model.py#L203">[source]</a></span></p>
<h2 id="graphautomodel-class">GraphAutoModel class</h2>
<pre><code class="python">autokeras.auto_model.GraphAutoModel(inputs, outputs, name='graph_auto_model', max_trials=100, directory=None, seed=None)
</code></pre>

<p>A HyperModel defined by a graph of HyperBlocks.</p>
<p>GraphAutoModel is a subclass of HyperModel. Besides the HyperModel properties,
it also has a tuner to tune the HyperModel. The user can use it in a similar
way to a Keras model since it also has <code>fit()</code> and  <code>predict()</code> methods.</p>
<p>The user can specify the high-level neural architecture by connecting the
HyperBlocks with the functional API, which is the same as
the Keras functional API.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>inputs</strong>: A list of or a HyperNode instances.
    The input node(s) of the GraphAutoModel.</li>
<li><strong>outputs</strong>: A list of or a HyperNode instances.
    The output node(s) of the GraphAutoModel.</li>
<li><strong>name</strong>: String. The name of the AutoModel. Defaults to 'graph_auto_model'.</li>
<li><strong>max_trials</strong>: Int. The maximum number of different Keras Models to try.
    The search may finish before reaching the max_trials. Defaults to 100.</li>
<li><strong>directory</strong>: String. The path to a directory for storing the search outputs.
    Defaults to None, which would create a folder with the name of the
    AutoModel in the current directory.</li>
<li><strong>seed</strong>: Int. Random seed.</li>
</ul>
<hr />
<h2 id="graphautomodel-methods">GraphAutoModel methods</h2>
<h3 id="fit_1">fit</h3>
<pre><code class="python">fit(x=None, y=None, validation_split=0, validation_data=None)
</code></pre>

<p>Search for the best model and hyperparameters for the AutoModel.</p>
<p>It will search for the best model based on the performances on
validation data.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>x</strong>: numpy.ndarray or tensorflow.Dataset. Training data x.</li>
<li><strong>y</strong>: numpy.ndarray or tensorflow.Dataset. Training data y.</li>
<li><strong>validation_split</strong>: Float between 0 and 1.
    Fraction of the training data to be used as validation data.
    The model will set apart this fraction of the training data,
    will not train on it, and will evaluate
    the loss and any model metrics
    on this data at the end of each epoch.
    The validation data is selected from the last samples
    in the <code>x</code> and <code>y</code> data provided, before shuffling. This argument is
    not supported when <code>x</code> is a dataset.</li>
<li>
<p><strong>validation_data</strong>: Data on which to evaluate
    the loss and any model metrics at the end of each epoch.
    The model will not be trained on this data.
    <code>validation_data</code> will override <code>validation_split</code>.
    <code>validation_data</code> could be:</p>
<ul>
<li>tuple <code>(x_val, y_val)</code> of Numpy arrays or tensors</li>
<li>tuple <code>(x_val, y_val, val_sample_weights)</code> of Numpy arrays</li>
<li>dataset or a dataset iterator</li>
</ul>
<p>For the first two cases, <code>batch_size</code> must be provided.
For the last case, <code>validation_steps</code> must be provided.</p>
</li>
<li>
<p><strong>**kwargs</strong>: Any arguments supported by keras.Model.fit.</p>
</li>
</ul>
<hr />
<h3 id="predict_1">predict</h3>
<pre><code class="python">predict(x, batch_size=32)
</code></pre>

<p>Predict the output for a given testing data.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>x</strong>: tf.data.Dataset or numpy.ndarray. Testing data.</li>
<li><strong>batch_size</strong>: Int. Defaults to 32.</li>
<li><strong>**kwargs</strong>: Any arguments supported by keras.Model.predict.</li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../nas/" title="Neural Architecture Search" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Neural Architecture Search
              </span>
            </div>
          </a>
        
        
          <a href="../hypermodel/block/" title="block" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                block
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.c648116f.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>